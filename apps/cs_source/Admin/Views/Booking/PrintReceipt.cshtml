@using System
@using System.Activities.Expressions
@using Vinaday.Data.Models
@using Vinaday.Data.Models.Extention
@using Vinaday.Web.Framework
@{
    ViewBag.Title = "PrintReceipt";
    Layout = "~/Views/Shared/_PdfLayout.cshtml";
    OrderModel order = ViewBag.Order;
    decimal discount = 0;
    var fullName = ViewBag.FullName;

}
<style>
    p {
        font-size: 15px !important;
    }

    body {
        color: #333 !important;
        font-size: 15px !important;
    }

    address {
        font-size: 13px !important;
    }

    .modal-footer p {
        font-size: 13px !important;
    }
</style>
<div class="modal-content" style="border: 2px dashed rgb(176, 176, 176)">
    <div class="modal-body">
        @if (order.Type == (int)Utilities.Product.Hotel)
        {

            <div class="panel-body" style="margin-top: -30px !important;">
                <div class="row">
                    <table style="width:100%">
                        <tr>
                            <td class="text-left" style="width:40%">
                                <img src="~/assets/images/logo.png" alt="" style="width: 200px; margin-left: -5px;" /><br />
                                <address>
                                    @*Charge Date: @DateTime.Now.ToString("dd MMM .yyyy")<br />*@
                                    Booking No.: <b>@string.Format("00{0}", order.Id)</b><br />
                                    PNR: <b>@order.Pnr</b>

                                </address>
                            </td>
                            <td class="text-right" style="width:60%; ">
                                <h2>VINADAY goREISE</h2>
                                <address>
                                    98A Le Lai street District 1, Ho Chi Minh City Vietnam<br />
                                    Tell: (84-28) -38 388 382<br>
                                    Email: cs@vinaday.com
                                </address>
                            </td>
                        </tr>
                    </table>

                    <div style="width: 100%">
                        <h3 style="text-align: center; padding: 0!important; margin: 0!important;">OFFICIAL RECEIPT</h3>
                        <hr>
                        <div class="pull-right">
                            <p class="text-right">
                                <strong>Receipt to</strong><br>
                                @order.Customer.Firstname @order.Customer.Lastname<br>
                                @Utilities.FormatPhone(order.Customer.PhoneNumber)<br>
                                @order.Customer.Email
                            </p>
                        </div>
                        <div class="pull-left">
                            <p class="text-left">
                                <strong>@order.ProductLink</strong><br>
                                @order.ProductName<br>
                                Check-in: @order.StartDate<br>
                                Check-out: @order.EndDate
                            </p>
                        </div>
                    </div>
                    <div class="col-sm-12 table-responsive">
                        <table class="table table-hover table-bordered">
                            <thead>
                                <tr>
                                    <th>Id</th>
                                    <th>Date</th>
                                    <th>Q.ty</th>
                                    <th>Price</th>
                                    <th>Surcharge</th>
                                    <th>Amount</th>
                                </tr>
                            </thead>
                            <tbody>

                                @if (order.OrderInformations.Count > 0)
                                {
                                    var index = 1;
                                    foreach (var detail in order.OrderInformations)
                                    {

                                        <tr>
                                            <td>@index</td>
                                            <td>@detail.Date</td>
                                            <td>@detail.Quantity</td>
                                            <td>@String.Format("{0:C}", @detail.Price)</td>
                                            <td>@Html.Raw(detail.Surcharge > 0 ? string.Format("{0}", @String.Format("{0:C}", detail.Surcharge)) : "N/A")</td>
                                            <td>@String.Format("{0:C}", (detail.Price + detail.Surcharge) * detail.Quantity)</td>
                                        </tr>
                                        index += 1;
                                    }
                                    <tr>
                                        <td colspan="5">Taxes and service charges are collected by operator suppliers (15%).</td>
                                        <td>@String.Format("${0}", order.TaxFee)</td>
                                    </tr>
                                }

                            </tbody>
                        </table>
                    </div>
                    <table style="width:100%">
                        <tr>
                            <td class="pull-left" style="width:60%">
                                @if (!string.IsNullOrEmpty(order.CancellationPolicy))
                                {
                                    <h4>CANCELLATION POLICY</h4>
                                    <p>
                                        @Html.Raw(order.CancellationPolicy)
                                    </p>
                                }
                            </td>
                            <td class="pull-right" style="width:30%">
                                <div class="text-right">
                                    @if (order.Status != (int)Utilities.BookingStatus.Paid)
                                    {
                                        <div>
                                            <h4 class="no-m m-t-sm">Unpaid yet </h4>
                                            <hr>
                                        </div>
                                    }
                                    @if (!string.IsNullOrEmpty(order.SurchargeName))
                                    {
                                        <div>

                                            <h4 class="no-m m-t-sm">Surcharge</h4>
                                            <h2 class="no-m">-@String.Format("{0:C}", @order.SurchargeFee)</h2>
                                            <hr>
                                        </div>
                                    }
                                    @if (order.ExtraBed > 0)
                                    {
                                        <div>

                                            <h4 class="no-m m-t-sm">Extra Bed Fee</h4>
                                            <h2 class="no-m">+@String.Format("{0:C}", order.ExtraBed)</h2>
                                            <hr>
                                        </div>
                                    }
                                    @if (order.ThirdPersonFee > 0)
                                    {
                                        <div>

                                            <h4 class="no-m m-t-sm">Third Person Fee</h4>
                                            <h2 class="no-m">+@String.Format("{0:C}", order.ThirdPersonFee)</h2>
                                            <hr>
                                        </div>
                                    }
                                    @if (!string.IsNullOrEmpty(order.DiscountName))
                                    {
                                        <div>

                                            <h4 class="no-m m-t-sm">Discount</h4>
                                            <h2 class="no-m">-@String.Format("{0:C}", @order.Discount)</h2>
                                            <hr>
                                        </div>
                                        decimal.TryParse(order.Discount, out discount);
                                    }
                                    <div>
                                        <h4 class="no-m m-t-md">Total</h4>
                                        <h1 class="no-m"><b>@String.Format("{0:C}", order.Amount + order.ExtraBed + order.ThirdPersonFee)</b></h1>
                                    </div>
                                    @if (order.CancelFee > 0)
                                    {
                                        <div>
                                            <hr>
                                            <h4 class="no-m m-t-md ">Cancel Fee</h4>
                                            <h1 class="no-m ">@String.Format("{0:C}", order.CancelFee)</h1>
                                        </div>
                                        <div>
                                            <hr>
                                            <h4 class="no-m m-t-md ">Total Final</h4>
                                            <h1 class="no-m ">@String.Format("{0:C}", order.CancelFee)</h1>
                                        </div>
                                    }
                                    @if (order.TotalRefund > 0)
                                    {
                                        <div>
                                            <hr>
                                            <h4 class="no-m m-t-md ">Refund</h4>
                                            <h1 class="no-m ">@String.Format("{0:C}", order.TotalRefund)</h1>
                                        </div>
                                        <div>
                                            <hr>
                                            <h4 class="no-m m-t-md ">Total Final</h4>
                                            <h1 class="no-m ">@String.Format("{0:C}", (order.Amount + order.ExtraBed + order.ThirdPersonFee - order.TotalRefund))</h1>
                                        </div>
                                    }
                                </div>

                            </td>
                        </tr>
                    </table>

                </div><!--row-->
            </div>

        }
        else if (order.Type == (int)Utilities.Product.Tour)
        {

            <div class="panel-body" style="margin-top: -30px !important;">
                <div class="row">
                    <table style="width:100%">
                        <tr>
                            <td class="text-left" style="width:40%">
                                <img src="~/assets/images/logo.png" alt="" style="width: 200px; margin-left: -10px;" /><br />
                                <address>
                                    Booking No.: <b>@string.Format("00{0}", order.Id)</b><br />
                                    PNR: <b>@order.Pnr</b>
                                </address>
                            </td>
                            <td class="text-right" style="width:60%">
                                <h2>VINADAY goREISE</h2>
                                <address>
                                    98A Le Lai street District 1, Ho Chi Minh City Vietnam<br />
                                    Tell: (84-28) -38 388 382<br>
                                    Email: cs@vinaday.com
                                </address>
                            </td>
                        </tr>
                    </table>

                    <div style="width: 100%">
                        <h3 style="text-align: center; padding: 0!important; margin: 0!important;">OFFICIAL RECEIPT</h3>
                        <hr>
                        <div class="pull-right">
                            <p class="text-right">
                                <strong>Receipt to</strong><br>
                                @order.Customer.Firstname @order.Customer.Lastname<br>
                                @Utilities.FormatPhone(order.Customer.PhoneNumber)<br>
                                @order.Customer.Email
                            </p>
                           
                        </div>
                        <div class="pull-left">
                            <p class="text-left">
                                <strong>@order.ProductName</strong><br>
                                Check-in: @order.DepartureOption @order.StartDate<br>
                            </p>
                            <div>
                                Offer: @order.Note <br />
                                Group Type: @order.GroupType <br />
                            </div>
                        </div>
                       
                    </div>
                    <div class="col-sm-12 table-responsive">
                        <table class="table table-hover table-bordered">
                            <thead>
                                <tr>
                                    <th>Id</th>
                                    <th>Date</th>
                                    <th>Q.ty</th>
                                    <th>Price</th>
                                    <th>Surcharge</th>
                                    <th>Amount</th>
                                </tr>
                            </thead>
                            <tbody>

                                <tr>
                                    <td>1</td>
                                    <td>@order.StartDate</td>
                                    <td>@order.Quantity</td>
                                    <td>@String.Format("{0:C}", @order.Price)</td>
                                    <td>@Html.Raw("N/A")</td>
                                    <td style="text-align: right">@String.Format("{0:C}", (order.Price) * order.Quantity)</td>
                                </tr>
                                @if (order.Children > 0)
                                {
                                    <tr>
                                        <td>2</td>
                                        <td>@order.StartDate</td>
                                        <td>Chidren @order.Children</td>
                                        <td>@String.Format("{0:C}", @order.Price / 2)</td>
                                        <td>@Html.Raw("N/A")</td>
                                        <td style="text-align: right">@String.Format("{0:C}", (order.Price / 2) * order.Children)</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                   
                    <table style="width:100%">
                        <tr>
                            <td class="text-left" style="width:60%">
                                @if (!string.IsNullOrEmpty(order.CancellationPolicy))
                                {
                                    <h4>CANCELLATION POLICY</h4>
                                    <p>
                                        @Html.Raw(order.CancellationPolicy)
                                    </p>
                                }

                            </td>
                            <td class="text-left" style="width:40%">
                                <div class="text-right">
                                    @if (!string.IsNullOrEmpty(order.Discount))
                                    {
                                        decimal.TryParse(order.Discount, out discount);
                                    }
                                    @if (!string.IsNullOrEmpty(order.DiscountName))
                                    {
                                        <div>
                                            <h4 class="no-m m-t-sm">Discount</h4>
                                            <h2 class="no-m">-@String.Format("{0:C}", discount)</h2>
                                            <hr>
                                        </div>
                                    }

                                    <div>
                                        <h4 class="no-m m-t-md">Total</h4>
                                        <h1 class="no-m">@String.Format("{0:C}", order.Amount)</h1>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </table>

                </div><!--row-->
            </div>

        }
        else if (order.Type == (int)Utilities.Product.OtherServices)
        {

            <div class="panel-body" style="margin-top: -30px !important;">
                <div class="row">
                    <table style="width:100%">
                        <tr>
                            <td class="text-left" style="width:40%">
                                <img src="~/assets/images/logo.png" alt="" style="width: 200px; margin-left: -10px;" /><br />
                                <address>
                                    Booking No.: <b>@string.Format("00{0}", order.Id)</b><br />
                                    PNR: <b>@order.Pnr</b>
                                </address>
                            </td>
                            <td class="text-right" style="width:60%">
                                <h2>VINADAY goREISE</h2>
                                <address>
                                    98A Le Lai street District 1, Ho Chi Minh City Vietnam<br />
                                    Tell: (84-28) -38 388 382<br>
                                    Email: cs@vinaday.com
                                </address>
                            </td>
                        </tr>
                    </table>
                    <div style="width: 100%">
                        <h3 style="text-align: center; padding: 0!important; margin: 0!important;">OFFICIAL RECEIPT</h3>
                        <hr>
                        <div class="pull-right">
                            <p class="text-right">
                                <strong>Receipt to</strong><br>
                                @order.Customer.Firstname @order.Customer.Lastname<br>
                                @Utilities.FormatPhone(order.Customer.PhoneNumber)<br>
                                @order.Customer.Email
                            </p>
                        </div>
                        <div class="pull-left">
                            <p class="text-left">
                                <strong>@order.ProductName</strong><br>
                                @order.Note<br>
                                Check-in: @order.StartDate<br>
                                Check-out: @order.EndDate<br>
                            </p>
                        </div>
                    </div>
                    <div class="col-sm-12 table-responsive">
                        <table class="table table-hover table-bordered">
                            <thead>
                            <tr>
                                <th>Id</th>
                                <th>Date</th>
                                <th>Q.ty</th>
                                <th>Price</th>
                                <th>Surcharge</th>
                                <th>Amount</th>
                            </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1</td>
                                    <td>@order.StartDate</td>
                                    <td>@order.Quantity</td>
                                    <td>@String.Format("{0:C}", @order.Price)</td>
                                    <td>@Html.Raw("N/A")</td>
                                    <td>@String.Format("{0:C}", (order.Price) * order.Quantity)</td>
                                </tr>
                                

                            </tbody>
                        </table>
                        
                    </div>

                    <div class="col-sm-12 table-responsive">
                        <table style="width:100%">
                            <tr>
                                <td class="text-left" style="width:60%">
                                    @if (!string.IsNullOrEmpty(order.CancellationPolicy))
                                    {
                                        <h4>CANCELLATION POLICY</h4>
                                        <p>
                                            @Html.Raw(order.CancellationPolicy)
                                        </p>
                                    }

                                </td>
                                <td class="text-left" style="width:40%">
                                    <div class="text-right">
                                        @if (!string.IsNullOrEmpty(order.Discount))
                                        {
                                            decimal.TryParse(order.Discount, out discount);
                                        }
                                        @if (!string.IsNullOrEmpty(order.DiscountName))
                                        {
                                            <div>
                                                <h4 class="no-m m-t-sm">Discount</h4>
                                                <h2 class="no-m">-@String.Format("{0:C}", discount)</h2>
                                                <hr>
                                            </div>
                                        }
                                        @if (order.Deposit > 0)
                                        {
                                            <div>
                                                <hr>
                                                <h4 class="no-m m-t-md">Deposit</h4>
                                                <h1 class="no-m ">
                                                    -@String.Format("{0:C}", order.Deposit)
                                                </h1>
                                            </div>
                                            <div>
                                                <hr>
                                                <h4 class="no-m m-t-md ">Balance</h4>
                                                <h1 class="no-m ">
                                                    @String.Format("{0:C}", (order.Amount + order.ExtraBed + order.ThirdPersonFee - discount - order.Deposit ?? 0))
                                                </h1>
                                            </div>
                                        }
                                        else
                                        {
                                            <div>
                                                <h4 class="no-m m-t-md">Total</h4>
                                                <h1 class="no-m">@String.Format("{0:C}", order.Amount)</h1>

                                            </div>
                                        }
                                      
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div><!--row-->
            </div>

        }

    </div>
    <div class="modal-footer">
        <div class="pull-left text-left">
            @if (order.Status == (int)Utilities.BookingStatus.Paid)
            {
                <div>
                    <h4 class="no-m m-t-sm">Guest's Signature</h4>
                    <br />
                    <br />
                    <br />
                    <h2 class="no-m">----------------</h2>
                </div>
            }
        </div>
        <div class=" pull-right text-right">

            <div>
                <h4 class="no-m m-t-sm">Issued by</h4>
                <br>
                <br>
                <br>
                <h2 class="no-m">----------------</h2>
                <span class="text-right pull-right" style="width: 200px">@fullName</span>
                <div class="clearfix"></div>
            </div>

        </div>
        <div class="clearfix"></div>
        <p class="pull-left text-left">
            In principle, all payments and receipts in Vietnam must be paid in Vietnamese Dong.<br />
            Theo Luật định, toàn bộ thanh toán ở Việt Nam phải thanh toán bằng tiền Đồng.
        </p>
    </div>
</div>
